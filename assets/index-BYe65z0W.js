(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const f of s.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&l(f)}).observe(document,{childList:!0,subtree:!0});function a(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(t){if(t.ep)return;t.ep=!0;const s=a(t);fetch(t.href,s)}})();const k="/platformer/assets/ninja_full.png",c=document.getElementById("gameCanvas"),n=c.getContext("2d"),e={x:100,y:260,width:32,height:64,vx:0,vy:0,speed:2,jumpPower:-7,onGround:!1,frameIndex:0,frameTimer:0,facing:1,isWalking:!1,state:"idle"},I=.3,h=new Image;h.src=k;const u={row:0,col:0,frames:1,frameRate:1,width:32,height:64},w={row:0,col:1,frames:6,frameRate:10,width:32,height:64},g={row:0,col:7,frames:3,frameRate:8,width:32,height:64},p={row:1,col:0,frames:1,frameRate:1,width:32,height:64},y={row:1,col:7,frames:3,frameRate:8,width:32,height:64},i={};window.addEventListener("keydown",r=>i[r.key]=!0);window.addEventListener("keyup",r=>i[r.key]=!1);function A(){e.isWalking=!1,i.ArrowDown||i.s?e.vx=0:i.ArrowLeft||i.a?(e.vx=-2,e.facing=-1,e.isWalking=!0):i.ArrowRight||i.d?(e.vx=e.speed,e.facing=1,e.isWalking=!0):e.vx=0,(i.ArrowUp||i.w||i[" "])&&e.onGround&&(e.vy=e.jumpPower,e.onGround=!1),e.vy+=I,e.x+=e.vx,e.y+=e.vy,e.y+e.height>=c.height-20&&(e.y=c.height-20-e.height,e.vy=0,e.onGround=!0);const o=e.width*1.5;e.x<0?(e.x=0,e.vx=0):e.x+o>c.width&&(e.x=c.width-o,e.vx=0),e.onGround?i.ArrowDown||i.s?e.state="crouch":e.isWalking?e.state="walk":e.state==="crouch"&&!(i.ArrowDown||i.s)?e.state="stand":e.state="idle":e.state="jump";let a;switch(e.state){case"walk":a=w;break;case"crouch":a=g;break;case"stand":a=p;break;case"jump":a=y;break;default:a=u}e.frameIndex>a.frames-1&&(e.frameIndex=a.frames-1),e.frameTimer++,e.state==="crouch"?e.frameIndex<a.frames-1&&e.frameTimer>=60/a.frameRate&&(e.frameIndex++,e.frameTimer=0):e.frameTimer>=60/a.frameRate&&(e.frameIndex=(e.frameIndex+1)%a.frames,e.frameTimer=0),e.state==="idle"&&(e.frameIndex=0,e.frameTimer=0)}function b(){n.clearRect(0,0,c.width,c.height),n.fillStyle="#444",n.fillRect(0,c.height-60,c.width,60);let r;switch(e.state){case"walk":r=w;break;case"crouch":r=g;break;case"stand":r=p;break;case"jump":r=y;break;default:r=u}let o=(r.col+e.frameIndex)*r.width,a=r.row*r.height,l=r.width,t=r.height;console.log({sx:o,sy:a,sw:l,sh:t});const s=1.5,f=e.height*s,d=e.width*s,m=e.x,v=e.y+e.height-f;n.save(),e.facing===-1&&(n.translate(m+d/2,0),n.scale(-1,1),n.translate(-m-d/2,0)),n.drawImage(h,o,a,l,t,m,v,d,f),n.restore()}function x(){A(),b(),requestAnimationFrame(x)}h.onload=()=>{x()};
